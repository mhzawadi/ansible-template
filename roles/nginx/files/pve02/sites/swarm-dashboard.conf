server {
  listen *:443 ssl;
  listen [::]:443 ssl;
  http2 on;
  server_name dashboard.example.cloud;
  root /var/data/websites/holding;
  index index.php index.html index.htm;

  if ($host = 'dashboard.example.cloud') {
    return 301 https://dashboard.example.com;
  }

  #SSL setting
  include /etc/nginx/conf.d/tls_cert_cloud.conf;
  include /etc/nginx/conf.d/headers.inc;

  # access_log /var/log/nginx/flame-access.log main;
  access_log off;

  location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto "https";
    proxy_set_header X-SECURE-REQUEST "true";
    proxy_set_header Host "dashboard.example.com";
    proxy_pass http://pve02-swarm;
  }
}

server {
  listen *:443 ssl;
  listen [::]:443 ssl;
    http2 on;
  server_name amh.ovh;
  root /var/data/websites/holding;
  index index.php index.html index.htm;

  if ($host = 'dashboard.example.cloud') {
    return 301 https://dashboard.example.com;
  }

  #SSL setting
  ssl_certificate /etc/letsencrypt/live/amh.ovh-0001/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/amh.ovh-0001/privkey.pem;
  include /etc/nginx/conf.d/headers.inc;

  # access_log /var/log/nginx/flame-access.log main;
  access_log off;

  location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto "https";
    proxy_set_header X-SECURE-REQUEST "true";
    proxy_set_header Host "dashboard.example.com";
    proxy_pass http://pve02-swarm;
  }
}
